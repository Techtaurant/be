# Pre-commit Hooks ì„¤ì •
# ê° ë„êµ¬ë¥¼ êµ¬ë¶„í•˜ê¸° ì‰½ë„ë¡ ì„¹ì…˜ë³„ë¡œ ì‘ì„±

# ============================================================================
# 1. Ruff - ì½”ë“œ í¬ë§·íŒ… ë° ë¦°íŒ… (Commit ì‹œ ì‹¤í–‰)
# ============================================================================
# Ruffë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ í¬ë§·íŒ…í•˜ê³  ë¦°íŠ¸ ê·œì¹™ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
# commit ì‹œì ì— ì‹¤í–‰ë˜ì–´ ì½”ë“œ ìŠ¤íƒ€ì¼ì„ ìë™ìœ¼ë¡œ ìˆ˜ì •í•©ë‹ˆë‹¤.
repos:
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.7.4
    hooks:
      # Ruff í¬ë§·í„°: ì½”ë“œ ìŠ¤íƒ€ì¼ ìë™ ìˆ˜ì •
      - id: ruff-format
        name: "ğŸ¨ Ruff Format (ì½”ë“œ í¬ë§·íŒ…)"
        stages: [pre-commit]
        types: [python]
        args: []

      # Ruff ë¦°í„°: ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ ë° ìë™ ìˆ˜ì •
      - id: ruff
        name: "ğŸ” Ruff Lint (ë¦°íŒ…)"
        stages: [pre-commit]
        types: [python]
        args: [--fix, --exit-non-zero-on-fix]

# ============================================================================
# 2. MyPy - íƒ€ì… ì²´í¬ (Push ì‹œ ì‹¤í–‰)
# ============================================================================
# MyPyë¥¼ ì‚¬ìš©í•˜ì—¬ Python íƒ€ì… íŒíŠ¸ë¥¼ ê²€ì¦í•©ë‹ˆë‹¤.
# push ì‹œì ì— ì‹¤í–‰ë˜ë©°, íƒ€ì… ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ pushê°€ ì°¨ë‹¨ë©ë‹ˆë‹¤.
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.11.2
    hooks:
      - id: mypy
        name: "ğŸ” MyPy (íƒ€ì… ì²´í¬)"
        stages: [pre-push]
        types: [python]
        additional_dependencies:
          - types-redis>=4.6.0
          - pydantic>=2.9.2
          - pydantic-settings>=2.6.0
          - sqlalchemy>=2.0.35
        args:
          - --config-file=pyproject.toml
          - --strict
        # app/ ë””ë ‰í† ë¦¬ë§Œ ì²´í¬
        files: ^app/

# ============================================================================
# 3. Pytest - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Push ì‹œ ì‹¤í–‰)
# ============================================================================
# Pytestë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
# push ì‹œì ì— ì‹¤í–‰ë˜ë©°, í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ pushê°€ ì°¨ë‹¨ë©ë‹ˆë‹¤.
  - repo: local
    hooks:
      - id: pytest
        name: "ğŸ§ª Pytest (ë‹¨ìœ„ í…ŒìŠ¤íŠ¸)"
        entry: pytest
        language: system
        stages: [pre-push]
        types: [python]
        pass_filenames: false
        always_run: true
        args:
          - tests/
          - -v
          - --tb=short

# ============================================================================
# ì¶”ê°€ ì„¤ì •
# ============================================================================
# default_install_hook_typesëŠ” ì„¤ì¹˜í•  hook íƒ€ì…ì„ ì§€ì •í•©ë‹ˆë‹¤.
# pre-commitê³¼ pre-push ë‘ ê°€ì§€ë¥¼ ëª¨ë‘ ì„¤ì¹˜í•©ë‹ˆë‹¤.
default_install_hook_types: [pre-commit, pre-push]
